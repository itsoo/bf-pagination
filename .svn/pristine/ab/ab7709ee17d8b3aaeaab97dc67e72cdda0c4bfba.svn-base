package com.sncfc.baseframework.pageplugin;

import com.fasterxml.jackson.annotation.JsonIgnore;
import lombok.AllArgsConstructor;
import lombok.Data;

import java.util.List;

/**
 * 结果页
 *
 * @author zxy
 */
@Data
@AllArgsConstructor
public final class PageInfo {

    /*** 封装 page 属性 */
    @JsonIgnore
    public static final String BEAN_MUST_HAS = "page";
    /*** 默认页容量 */
    @JsonIgnore
    static Integer defaultPageSize = 10;
    /*** 分页属性 false 不分页 */
    @JsonIgnore
    private boolean pageList = true;

    /*** 当前页数 */
    private Integer pageNum = 1;
    /*** 页容量 */
    private Integer pageSize = defaultPageSize;
    /*** 总页数 */
    private Integer totalPage = 0;
    /*** 总记录数 */
    private Integer totalCount = 0;
    /*** 查询结果集 */
    private List<?> dataList;
    /*** 有上一页 */
    private boolean hasPrePage;
    /*** 有下一页 */
    private boolean hasNextPage;

    public PageInfo(List<?> dataList) {
        this.dataList = dataList;
    }

    /**
     * 得到分页起始行号
     *
     * @return int
     */
    public int getStartRows() {
        return (pageNum - 1) * pageSize;
    }

    /**
     * 得到分页结束行号
     *
     * @return int
     */
    public int getEndRows() {
        return pageNum * pageSize;
    }

    private void setTotalPage(int totalCount) {
        int result = (int) Math.ceil(((double) totalCount) / pageSize);
        totalPage = result == 0 ? 1 : result;
    }

    private boolean getHasPrePage() {
        return hasPrePage = pageNum > 1;
    }

    private boolean getHasNextPage() {
        return hasPrePage = pageNum < totalPage;
    }
}
